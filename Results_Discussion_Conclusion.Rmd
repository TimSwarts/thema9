---
title: "Results + Discussion & Conclusion"
author: "Tim Swarts"
date: "06/10/2021"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```
\newpage
# Research question
Which attributes best predict breast cancer malignancy?

# Results

```{r, results='hide', message=FALSE}
library(tibble)
library(dplyr)
library(ggplot2)
library(ggrepel)
library(reshape2)
library(scales)
```

```{r, results='hide', message=FALSE}
# Read data
data <- read.csv("breast-cancer-wisconsin.data", na.strings = '?')
# Convert to tibble for readability later on
data <- as_tibble(data)
# Set column names
colnames(data) <- c("id", "Clump_Thickness", "Cell_Size_Uniformity", "Cell_Shape_Uniformity",                        "Marginal_Adhesion", "Single_Epithelial_Cell_Size", "Bare_Nuclei",
                    "Bland_Chromatin", "Normal_Nucleoli", "Mitoses", "Class")
```

```{r}
# Make correlation matrix
cormat <- cor(na.omit(data[, -1]))
# Melt to correct format
melted.cormat <- melt(cormat, value.name = "Correlation")
# head(melted.cormat) # <- uncomment this to look at the new matrix

# Make heatmap with ggplot
ggplot(data = melted.cormat, aes(x=Var1, y=Var2, fill=Correlation)) + 
  geom_tile() + # geom_tile makes the heatmap tiles
  scale_fill_gradient(low = rgb(0, 0, 0),
                      high = rgb(0, 1, 1),
                      guide = "colorbar") + # sets color the gradient for tiles
  ylab('') +
  xlab('') + # the x and y axes have no useful names, and are thus left blank
  labs(caption =
      "Figure 1 ~ Correlation Heatmap of the breast cancer data set.
      The lighter the color, the better the correlation between the two columns.") + # adds caption
  theme_minimal() + # set theme to minimal
  theme(axis.text.x = element_text(angle = 45, hjust = 1), # adjust x labels to be diagonal
        plot.caption = element_text(hjust = 0.7)) # adjust caption position

```

As depicted in figure 1, shown above, three attributes have a correlation of 75% or higher with the class attribute. These are cell size uniformity, cell shape uniformity, bare nuclei, and bland chromatin respectively. Furthermore, cell shape uniformity and cell size uniformity show a high correlation with each other, roughly 91%.


